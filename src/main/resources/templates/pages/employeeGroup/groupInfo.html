<!DOCTYPE html>
<!--[if lt IE 7]> <html class="ie lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html class="ie lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html class="ie lt-ie9"> <![endif]-->
<!--[if gt IE 8]> <html class="ie gt-ie8"> <![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org" >
	<head>
		<!-- Meta -->
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE" />
		
		<!-- Bootstrap -->
		<link th:href="@{/common/bootstrap/css/bootstrap.css}" rel="stylesheet" />
		<link th:href="@{/common/bootstrap/css/responsive.css}" rel="stylesheet" />
		
		<!-- Glyphicons Font Icons -->
		<link th:href="@{/common/theme/css/glyphicons.css}" rel="stylesheet" />
		
		<!-- Uniform Pretty Checkboxes -->
		<link th:href="@{/common/theme/scripts/plugins/forms/pixelmatrix-uniform/css/uniform.default.css}" rel="stylesheet" />
		
		<!-- PrettyPhoto -->
	    <link th:href="@{/common/theme/scripts/plugins/gallery/prettyphoto/css/prettyPhoto.css}" rel="stylesheet" />
		
		<!-- Bootstrap Extended -->
		<link th:href="@{/common/bootstrap/extend/jasny-bootstrap/css/jasny-bootstrap.min.css}" rel="stylesheet">
		<link th:href="@{/common/bootstrap/extend/jasny-bootstrap/css/jasny-bootstrap-responsive.min.css}" rel="stylesheet">
		<link th:href="@{/common/bootstrap/extend/bootstrap-wysihtml5/css/bootstrap-wysihtml5-0.0.2.css}" rel="stylesheet">
		<link th:href="@{/common/bootstrap/extend/bootstrap-select/bootstrap-select.css}" rel="stylesheet" />
		<link th:href="@{/common/bootstrap/extend/bootstrap-toggle-buttons/static/stylesheets/bootstrap-toggle-buttons.css}" rel="stylesheet" />
		
		<!-- Select2 Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/forms/select2/select2.css}" rel="stylesheet" />
		
		<!-- DateTimePicker Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/forms/bootstrap-datetimepicker/css/datetimepicker.css}" rel="stylesheet" />
		
		<!-- JQueryUI -->
		<link th:href="@{/common/theme/scripts/plugins/system/jquery-ui/css/smoothness/jquery-ui-1.9.2.custom.min.css}" rel="stylesheet" />
		
		<!-- MiniColors ColorPicker Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/color/jquery-miniColors/jquery.miniColors.css}" rel="stylesheet" />
		
		<!-- Notyfy Notifications Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/notifications/notyfy/jquery.notyfy.css}" rel="stylesheet" />
		<link th:href="@{/common/theme/scripts/plugins/notifications/notyfy/themes/default.css}" rel="stylesheet" />
		
		<!-- Gritter Notifications Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/notifications/Gritter/css/jquery.gritter.css}" rel="stylesheet" />
		
		<!-- Easy-pie Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/charts/easy-pie/jquery.easy-pie-chart.css}" rel="stylesheet" />
	
		<!-- Google Code Prettify Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/other/google-code-prettify/prettify.css}" rel="stylesheet" />
	
		<!-- Main Theme Stylesheet :: CSS -->
		<link th:href="@{/common/theme/css/style-dark.css?1369414383}" rel="stylesheet" />
		
		<!-- Select2 Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/forms/select2/select2.css}" rel="stylesheet" />
		<!-- Select2 Plugin -->
		<link th:href="@{/common/theme/scripts/plugins/forms/select2/select2.css}" rel="stylesheet" />
	</head>
	<body>
		<ul class="breadcrumb">
			<li><a href="javascript:void(0)" onclick="showMain('/employeeGroup/query')" class="glyphicons user_add"><i></i>分组信息</a></li>
			<li class="divider"></li>
			<li th:text="${employeeGroup.id eq 0 ? '添加分组' : '编辑分组'}">添加分组</li>
		</ul>
		<div class="separator bottom"></div>
		<div class="innerLR">
			<!-- Form -->
			<form th:object="${employeeGroup}" th:action="*{id eq 0 ? '/employeeGroup/insert' : '/employeeGroup/update'}" class="form-horizontal" style="margin-bottom: 0;" id="groupForm" method="post" autocomplete="off">
				<div class="widget">
					<!-- Widget heading -->
					<div class="widget-head">
						<h4 class="heading">分组信息</h4>
					</div>
					<!-- // Widget heading END -->
					<div class="widget-body">
						<div class="row-fluid">
							<!-- Group -->
							<div class="control-group">
								<label class="control-label" for="name">分组名称</label>
								<div class="controls">
									<input class="span6" th:field="*{name}" type="text" placeholder="请输入角色名称"/>
									<input th:if="*{id}" type="hidden" th:field="*{id}" />
								</div>
							</div>
							<!-- // Group END -->
							<!-- Group -->
							<div class="control-group">
								<label class="control-label" for="role">所属角色</label>
								<div class="controls">
									<select id="role_select" th:field="*{roleId}" class="span6">
										<option th:each="r:${roleList}" th:value="${r.id}" th:text="${r.name}" 
						               		th:selected="${r.id==roleId ? 'selected' : 'false'}">
								         </option>
									</select>
								</div>
							</div>
							<!-- // Group END -->
						</div>
						<div class="row-fluid">
							<!-- Group -->
							<div class="control-group">
								<label class="control-label" for="hr"></label>
								<div class="controls">
									
								</div>
							</div>
						</div>
						<div class="row-fluid">
							<!-- Group -->
							<div class="control-group">
								<label class="control-label" for="hr"></label>
								<div class="controls">
									
								</div>
							</div>
						</div>
						<div class="row-fluid">
							<!-- Group -->
							<div class="control-group">
								<label class="control-label" for="memo">描述信息</label>
								<div class="controls">
									<textarea class="wysihtml5 span6" style="resize: none;height: 80px;" placeholder="请输入角色名称" th:field="*{memo}"></textarea>
								</div>
							</div>
							<!-- // Group END -->
						</div>
						<div class="row-fluid">
							<!-- Group -->
							<div class="control-group">
								<label class="control-label" for="hr"></label>
								<div class="controls">
									
								</div>
							</div>
						</div>
						<hr class="separator">
						<div class="form-actions">
							<button type="submit" id="subData" disabled="disabled" class="btn btn-success btn-icon glyphicons ok"><i></i>保&nbsp;存</button>
							<button type="button" class="btn btn-icon btn-default glyphicons circle_remove" onclick="showMain('/employeeGroup/query')"><i></i>取&nbsp;消</button>
						</div>
					</div>
				</div>
			</form>
		</div>
		<script type="text/javascript">
			$(document).ready(function(){
				$("#role_select").select2();
				$("#subData").removeAttr("disabled");
			});
			$.validator.setDefaults(
			{
				submitHandler: function() { 
					//alert("submitted!");
					saveData();
				},
				showErrors: function(map, list) 
				{
					this.currentElements.parents('label:first, .controls:first').find('.error').remove();
					this.currentElements.parents('.control-group:first').removeClass('error');
					
					$.each(list, function(index, error) 
					{
						var ee = $(error.element);
						var eep = ee.parents('label:first').length ? ee.parents('label:first') : ee.parents('.controls:first');
						
						ee.parents('.control-group:first').addClass('error');
						eep.find('.error').remove();
						eep.append('<p class="error help-block"><span class="label label-important">' + error.message + '</span></p>');
					});
					//refreshScrollers();
				}
			});
			
			jQuery.validator.addMethod("checkName",function(value,element){
				var flag = false;
				if(value != ''){
					$.ajax({
						url:"/employeeGroup/checkName",
						data:"name=" + value,
						dataType:"text",
						async:false,
						success:function(groupId){
							if(groupId == 0 || groupId == '0' || groupId == $("#id").val()){
								flag = true;
							}
						}
					});
				}
				return flag;
			});
			
			$("#groupForm").validate({
				rules:{
					name:{
						required: true,
						minlength: 2,
						maxlength: 25,
						checkName: true
					},
					memo:{
						maxlength: 20
					}
				},
				messages:{
					name:{
						required: "请输入分组名称",
						minlength: "请输入至少两个字符组成的名称",
						maxlength: "名称不能超过25个字",
						checkName: "分组名称信息重复，请重新输入"
					},
					memo:{
						maxlength: "描述信息不能超过20个字"
					}
				}
			});
			
			function saveData(){
				$.ajax({
		             type: "POST",
		             url: $("#groupForm").prop("action"),
		             data: $("#groupForm").serialize(),
		             success: function (result) {
		            	 $("#content").html(result);
		             }
		    	 });
			}
		</script>
	</body>
</html>